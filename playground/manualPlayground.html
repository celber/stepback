<html>
    <head>
        <script type="application/javascript" src="https://unpkg.com/codeflask/build/codeflask.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/split.js/1.5.11/split.min.js"></script>
        <style>
            body {
                margin: 0;
                display: flex;
                align-items: stretch;
            }
            #editorWrapper {
                position: relative;
                min-height: 100%;
            }
            .gutter {
                background-color: #eaeaea;
    background-image: repeating-linear-gradient(45deg, transparent, transparent 35px, rgba(255,255,255,.5) 35px, rgba(255,255,255,.5) 70px);
            }
            
            #resultPanel {
                border: none;
                background-color: #fafafa;
                min-height: 100%;
            }
            #runBtn {
                position: absolute;
                bottom: 0;
                right: 0;
                z-index: 999;
            }
        </style>
    </head>
    <body>
        <div id='editorWrapper'>
                <div id="editorPanel">

                </div>
                <button id="runBtn">Run</button>
        </div>

        <iframe id="resultPanel">
            
        </iframe>

    </body>
    <script>
        var flask = new CodeFlask('#editorPanel', { language: 'js', lineNumbers: true });

        flask.updateCode(
            "var viewport = new Sb.layout.Fit({ \r\n"+
            "   items: [{ \r\n"+
            "        componentType: 'container',\r\n"+
            "        classList: ['green-bg'],\r\n"+
            "        items: [{\r\n"+
            "            componentType: \"zen:button\",\r\n"+
            "            primary: true,\r\n"+
            "            text: \"Click Me!\"\r\n"+
            "        }]\r\n"+
            "    }]\r\n"+
            "});\r\n\r\n"+
            "viewport.renderTo(Sb.queryOne(\"#app\"));"
        );

        document.getElementById('runBtn').onclick = function () {
            var code = flask.getCode();
            var frameDoc = document.getElementById('resultPanel').contentWindow.document;
            frameDoc.open();
            frameDoc.write(`
                <head>
                    <script type=\"application/javascript\" src=\"../dist/k.js\"> <\/script>
                    <link rel=\"stylesheet\" href=\"../dist/k.css\"/>
                    <style>
                                #app {
                                    height: 40px;
                                    width: 500px;
                                }
                                body {
                                    background-color: #fafafa;
                                      margin: 0; 
                                }
            
                                .green-bg {
                                    background-color: #00ff0022;
                                }
            
                                .sb-fit-container {
                                    background-color: #ff000022;
                                }
                    <\/style>
            <\/head>
            <body>
                <div id=\"app\"><\/div>
            <\/body>
            <script type=\"application/javascript\">
            code +
            <\/script>`
            );
            frameDoc.close();
        }
        

        Split(['#editorWrapper', '#resultPanel'], {
            sizes: [25, 75],
            gutterSize: 20,
        })
    </script>
</html>